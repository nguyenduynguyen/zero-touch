
groups {
    re0 {
        system {
            host-name Zero_Touch-re0;
        }
    }
    re1 {
        system {
            host-name Zero_Touch-re1;
        }
    }
}
apply-groups [ re0 re1 ];
system {
    host-name Zero_Touch;
    root-authentication {
        encrypted-password "$1$wwMZuqe9$xn/UQAlIyjrjoeMXc99Bg1"; ## SECRET-DATA
    }
    commit synchronize;
    login {
        class autoconfig {
            idle-timeout 5;
            permissions [ view view-configuration ];
            allow-commands show;
        }
        class operators {
            idle-timeout 10;
            permissions [ clear configure firewall firewall-control interface-control network rollback view view-configuration ];
            allow-configuration-regexps [ "protocols isis" routing-instances ];
            deny-configuration-regexps [ chassis access accounting-options apply-groups forwarding-options groups policy-options services snmp system ethernet-switching-options routing-options poe class-of-service jsrc jsrc-partition multicast-snooping-options dynamic-profiles diameter unified-edge switch-options fabric ];
        }
        class view-config {
            idle-timeout 5;
            permissions [ view view-configuration ];
        }
        class view-interfaces {
            permissions [ interface view ];
            allow-commands "show interfaces diagnostics optics.*|show interfaces .*|exit*|monitor interface .*|(^ping .*host.*)|show chassis (routing-engine|environment|hardware)";
            deny-commands .*;
        }
        user Superuser {
            uid 2005;                   
            class super-user;
        }
        user admin {
            uid 2000;
            class super-user;
            authentication {
                encrypted-password "$6$jLBn0u.D$7pGm88WmFISGebI5SolSK8yUdFQWSglACSz/X.rKbgQnPtfcgo1IaLPP3dQol9p7q9g9hsMJhfAo7FzaU17TX."; ## SECRET-DATA
            }
        }
        user autoconfig {
            uid 2002;
            class autoconfig;
        }
        user dungnt {
            uid 2001;
            class super-user;
            authentication {
                encrypted-password "$6$Rj6XhwgC$Hor2BSdkSYQ6QiQ5yEM82cwTR4mq7tWo6lhb0seh8ZJmoQ0MpppKW.GQoI9YX7Zs88i.HBeuOhQZu/AhDDruy1"; ## SECRET-DATA
            }
        }
        user lenq {
            uid 2003;
            class super-user;
            authentication {
                encrypted-password "$1$VWUiyNi9$woRGBJ31ZcMN.eHmf.NLP0"; ## SECRET-DATA
            }
        }
        user nghiatm {
            uid 2009;
            class super-user;
            authentication {
                encrypted-password "$1$HEtS6.vX$hH9oIZWjKoxPzKTqonCcY1"; ## SECRET-DATA
            }
        }
        user nguyennd {
            uid 2007;
            class super-user;
            authentication {
                encrypted-password "$6$2DbJPXUP$po64dAwQ2O8HqzDjm60JkGnkzshDLU1XPk63hRNWolg8qB3ZcpHvB5AabArEGWz7SzKNQfypEvr.90uoQina8."; ## SECRET-DATA
            }
        }
        user operators {
            uid 2004;
            class operators;
        }                               
        user view-config {
            uid 2006;
            class view-config;
        }
        user viewinterface {
            uid 2010;
            class view-interfaces;
        }
    }
    services {
        ssh {
            protocol-version v2;
            max-sessions-per-connection 32;
        }
        netconf {
            ssh;
        }
    }
    time-zone Asia/Saigon;
    authentication-order [ tacplus password ];
    name-server {
        112.197.1.8;
    }
    tacplus-server {
        10.255.230.246 {
            port 49;
            secret "$9$ogZi.z36t0B36pBREKvMWLN-Vws2aJGX7wg4aHk"; ## SECRET-DATA
            source-address 10.254.200.254;
        }
        10.255.255.251 {
            port 49;
            secret "$9$ogZi.z36t0B36pBREKvMWLN-Vws2aJGX7wg4aHk"; ## SECRET-DATA
            source-address 10.254.200.254;
        }
    }
    allow-v4mapped-packets;
    syslog {
        apply-flags omit;
        user * {
            any emergency;
        }
        host 10.255.254.212 {
            any notice;
            source-address 10.254.200.254;
        }                               
        host 10.255.254.188 {
            any notice;
        }
        host 10.255.254.235 {
            any notice;
            source-address 10.254.200.254;
        }
        host 10.255.254.18 {
            source-address 10.254.200.254;
        }
        file messages {
            any notice;
            authorization info;
        }
        file interactive-commands {
            interactive-commands any;
        }
        file default-log-messages {
            any info;
            match "(requested 'commit' operation)|(copying configuration to juniper.save)|(commit complete)|ifAdminStatus|(FRU power)|(FRU removal)|(FRU insertion)|(link UP)|transitioned|Transferred|transfer-file|(license add)|(license delete)|(package -X update)|(package -X delete)|(FRU Online)|(FRU Offline)|(plugged in)|(unplugged)|CFMD_CCM_DEFECT| LFMD_3AH | RPD_MPLS_PATH_BFD|(Master Unchanged, Members Changed)|(Master Changed, Members Changed)|(Master Detected, Members Changed)|(vc add)|(vc delete)|(Master detected)|(Master changed)|(Backup detected)|(Backup changed)|(interface vcp-)|(AIS_DATA_AVAILABLE)";
            structured-data;
        }
        file interface_status {
            daemon info;
            match "(SNMP_TRAP_LINK_UP|SNMP_TRAP_LINK_DOWN)";
            explicit-priority;
        }
        file kernel-notice {
            kernel notice;
        }
    }
    max-configurations-on-flash 49;
    archival {
        configuration {
            transfer-on-commit;
            archive-sites {
                "ftp://user:userviewconfig@172.16.123.224";
            }
        }
    }
    processes {
        dhcp-service {                  
            traceoptions {
                file dhcp_logfile size 10m;
                level all;
                flag packet;
            }
        }
    }
    ntp {
        server 112.197.1.8;
    }
}
chassis {
    redundancy {
        routing-engine 0 master;
        failover {
            on-loss-of-keepalives;
            on-disk-failure;
        }
        graceful-switchover;
    }
    aggregated-devices {
        ethernet {
            device-count 30;
        }
    }
    fpc 0 {
        pic 0 {
            tunnel-services;
        }
    }
    fpc 2 {
        pic 0 {
            tunnel-services;
        }
    }
    alarm {
        management-ethernet {
            link-down ignore;
        }
    }
    network-services enhanced-ip;
}
interfaces {
    lo0 {
        unit 0 {
            family inet {
                filter {
                    input-list [ accept-bgp accept-bfd accept-ldp accept-rsvp accept-common-services accept-established accept-pim accept-igmp discard-all ];
                }
                address 10.254.200.254/32;
            }
            family iso {
                address 49.0003.0102.5420.0254.00;
            }
            family inet6 {
                address 2403:e200::ffff:10.254.200.254/128;
            }
        }
       
    }
}
snmp {
    location "Zero_Touch";
    contact ROUTER;
    filter-duplicates;
    community sctvcommx5 {
        authorization read-only;
        clients {
            10.255.254.212/32;
            10.255.230.250/32;
            10.255.230.251/32;          
            112.197.1.59/32;
            112.197.47.224/32;
            112.197.1.52/32;
            172.16.123.224/32;
            112.197.47.225/32;
            172.16.123.225/32;
            112.197.47.23/32;
            112.197.47.22/32;
            112.197.47.19/32;
            112.197.47.223/32;
            112.197.12.150/32;
            112.197.47.28/32;
            10.255.254.196/32;
            10.255.254.235/32;
            112.197.47.241/32;
            10.255.254.236/32;
            10.255.230.247/32;
            172.16.123.83/32;
            172.16.123.67/32;
        }
    }
    routing-instance-access;
}
policy-options {
    prefix-list router-ipv4 {
        apply-path "interfaces <*> unit <*> family inet address <*>";
    }
    prefix-list localhost {
        127.0.0.0/8;
    }
    prefix-list multicast-all-routers {
        224.0.0.2/32;
    }
    prefix-list pim {
        224.0.0.13/32;
    }
    prefix-list bgp-neighbors {
        apply-path "protocols bgp group <*> neighbor <*>";
    }
    prefix-list ntp-servers {
        apply-path "system ntp server <*>";
    }
    prefix-list snmp-community-clients {
        apply-path "snmp community <*> clients <*>";
    }                                   
    prefix-list tacas-servers {
        apply-path "system tacplus-server <*>";
    }
    prefix-list dns-servers {
        apply-path "system name-server <*>";
    }
    prefix-list ntp-server {
        apply-path "system ntp server <*>";
    }
    prefix-list ntp-server-peers {
        apply-path "system ntp peer <*>";
    }
    prefix-list rfc1918 {
        10.0.0.0/8;
        112.197.47.241/32;
        172.16.0.0/12;
        192.168.0.0/16;
    }
    prefix-list igmp {
        224.0.0.0/4;
    }
    prefix-list pim-rp {
        112.197.4.49/32;
    }
    prefix-list tacacs-server {
        apply-path "system tacplus-server <*>";
    }
    prefix-list BGP-ADDRESSES {
        apply-path "protocols bgp group <*> neighbor <*>";
    }
    prefix-list INTERNAL-ADDRESSES {
        0.0.0.0/0;
    }
    prefix-list SSH-TELNET {
        0.0.0.0/0;
    }
    prefix-list LOCALHOST {
        127.0.0.1/32;
    }
    prefix-list SNMP {
        0.0.0.0/0;
    }
    prefix-list NTP-ADDRESSES {
        apply-path "system ntp server <*>";
    }                                   
    prefix-list TACACPLUS {
        0.0.0.0/0;
    }
    prefix-list PREFIX-REDIRECT-CGNAT-DNG {
        100.100.0.0/16;
    }
    policy-statement EXP-HCM-RR-01 {
        term REDISTRIBUTE-ISIS-ROUTE {
            from {
                protocol isis;
                level 1;
                route-filter 27.2.0.0/15 orlonger;
                route-filter 112.197.0.0/16 orlonger;
                route-filter 100.64.0.0/10 orlonger;
                route-filter 172.16.0.0/12 longer;
                route-filter 10.0.0.0/8 longer;
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
        term REDISTRIBUTE-STATIC-ROUTE {
            from {
                protocol static;
                route-filter 27.2.0.0/15 orlonger;
                route-filter 112.197.0.0/16 orlonger;
                route-filter 100.64.0.0/10 orlonger;
                route-filter 172.16.0.0/12 longer;
                route-filter 10.0.0.0/8 longer;
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
        term REDISTRIBUTE-ISIS-ROUTEv6 {
            from {
                family inet6;
                protocol isis;
                level 1;                
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
    }
    policy-statement EXP-HNI-RR-01 {
        term REDISTRIBUTE-ISIS-ROUTE {
            from {
                protocol isis;
                level 1;
                route-filter 27.2.0.0/15 orlonger;
                route-filter 112.197.0.0/16 orlonger;
                route-filter 100.64.0.0/10 orlonger;
                route-filter 172.16.0.0/12 longer;
                route-filter 10.0.0.0/8 longer;
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
        term REDISTRIBUTE-STATIC-ROUTE {
            from {
                protocol static;
                route-filter 27.2.0.0/15 orlonger;
                route-filter 112.197.0.0/16 orlonger;
                route-filter 100.64.0.0/10 orlonger;
                route-filter 172.16.0.0/12 longer;
                route-filter 10.0.0.0/8 longer;
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
        term REDISTRIBUTE-ISIS-ROUTEv6 {
            from {                      
                family inet6;
                protocol isis;
                level 1;
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
    }
    policy-statement FILTER-OUT-TO-RP {
        term REJECT {
            from {
                route-filter 224.0.0.0/4 orlonger;
            }
            then reject;
        }
    }
    policy-statement IMP-HCM-RR-01 {
        term ACCEPT-ALL {
            then accept;
        }
        term REJECT {
            then reject;
        }
    }
    policy-statement IMP-HNI-RR-01 {
        term Default-Route {
            from {
                next-hop 10.254.200.10;
                route-filter 0.0.0.0/0 exact;
            }
            then {
                local-preference 300;
                accept;
            }
        }
        term ACCEPT-ALL {
            then {
                local-preference 100;
                accept;
            }
        }                               
        term REJECT {
            then reject;
        }
    }
    policy-statement LOAD-BALANCE-ALL {
        then {
            load-balance per-packet;
        }
    }
    policy-statement REDISTRIBUTE-ROUTE-TO-ISIS {
        term L1-TO-L2 {
            from {
                protocol isis;
                level 1;
            }
            to {
                protocol isis;
                level 2;
            }
            then reject;
        }
    }
    community COMM-LOCAL members [ 45543:5000 45543:54000 ];
}
class-of-service {
    classifiers {
        dscp CL-DSCP {
            forwarding-class BE {
                loss-priority low code-points 001000;
                loss-priority high code-points 000000;
            }
            forwarding-class AF {
                loss-priority low code-points 010010;
                loss-priority medium-low code-points af22;
                loss-priority medium-high code-points af23;
            }
            forwarding-class L1 {
                loss-priority low code-points 011010;
            }
            forwarding-class H2 {
                loss-priority low code-points 100010;
            }
            forwarding-class EF {
                loss-priority low code-points 101110;
            }                           
            forwarding-class NC {
                loss-priority low code-points 110000;
            }
        }
        exp CL-EXP {
            forwarding-class BE {
                loss-priority low code-points 001;
                loss-priority high code-points 000;
            }
            forwarding-class AF {
                loss-priority low code-points 010;
            }
            forwarding-class L1 {
                loss-priority low code-points 011;
            }
            forwarding-class H2 {
                loss-priority low code-points 100;
            }
            forwarding-class EF {
                loss-priority low code-points 101;
            }
            forwarding-class NC {
                loss-priority low code-points 110;
            }
        }
        inet-precedence CL-INET-PRECEDENCE {
            forwarding-class BE {
                loss-priority low code-points 001;
                loss-priority high code-points 000;
            }
            forwarding-class AF {
                loss-priority low code-points 010;
            }
            forwarding-class L1 {
                loss-priority low code-points 011;
            }
            forwarding-class H2 {
                loss-priority low code-points 100;
            }
            forwarding-class EF {
                loss-priority low code-points 101;
            }
            forwarding-class NC {
                loss-priority low code-points 110;
            }                           
        }
    }
    forwarding-classes {
        class NC queue-num 3;
        class EF queue-num 6;
        class H2 queue-num 5;
        class L1 queue-num 4;
        class AF queue-num 2;
        class BE queue-num 0;
    }
    interfaces {
        ge-*/*/* {
            scheduler-map queue-table;
            unit * {
                forwarding-class BE;
            }
        }
        xe-*/*/* {
            scheduler-map queue-table;
            unit * {
                forwarding-class BE;
            }
        }
       
        ae* {
            scheduler-map queue-table;
            unit * {
                forwarding-class BE;
            }
        }
     
    }
    rewrite-rules {
        dscp RW-DSCP {
            forwarding-class BE {
                loss-priority low code-point 001000;
                loss-priority high code-point 000000;
            }
            forwarding-class AF {
                loss-priority low code-point 010010;
                loss-priority medium-low code-point af22;
                loss-priority medium-high code-point af23;
            }
            forwarding-class L1 {
                loss-priority low code-point 011010;
            }
            forwarding-class H2 {
                loss-priority low code-point 100010;
            }
            forwarding-class EF {
                loss-priority low code-point 101110;
            }
            forwarding-class NC {
                loss-priority low code-point 110000;
            }
        }
        exp RW-EXP {
            forwarding-class BE {
                loss-priority low code-point 001;
                loss-priority high code-point 000;
            }
            forwarding-class AF {
                loss-priority low code-point 010;
            }
            forwarding-class L1 {
                loss-priority low code-point 011;
            }                           
            forwarding-class H2 {
                loss-priority low code-point 100;
            }
            forwarding-class EF {
                loss-priority low code-point 101;
            }
            forwarding-class NC {
                loss-priority low code-point 110;
            }
        }
    }
    scheduler-maps {
        queue-table {
            forwarding-class NC scheduler s-NC;
            forwarding-class BE scheduler s-BE;
            forwarding-class AF scheduler s-AF;
            forwarding-class L1 scheduler s-L1;
            forwarding-class H2 scheduler s-H2;
            forwarding-class EF scheduler s-EF;
        }
        queue-table-1ge {
            forwarding-class NC scheduler 1GE-NC;
            forwarding-class BE scheduler 1GE-BE;
            forwarding-class H2 scheduler 1GE-H2;
            forwarding-class EF scheduler 1GE-EF;
            forwarding-class AF scheduler 1GE-AF;
            forwarding-class L1 scheduler 1GE-L1;
        }
    }
    schedulers {
        s-NC {
            transmit-rate percent 1;
            buffer-size percent 1;
            priority high;
        }
        s-EF {
            transmit-rate percent 15;
            buffer-size percent 15;
            priority strict-high;
        }
        s-H2 {
            transmit-rate percent 30;
            buffer-size percent 30;
            priority high;
        }                               
        s-L1 {
            transmit-rate percent 15;
            buffer-size percent 15;
            priority medium-high;
        }
        s-AF {
            transmit-rate percent 10;
            buffer-size percent 10;
            priority medium-high;
        }
        s-BE {
            transmit-rate percent 29;
            buffer-size percent 29;
            priority low;
        }
        1GE-NC {
            transmit-rate percent 1;
            buffer-size percent 1;
            priority high;
        }
        1GE-EF {
            transmit-rate percent 1;
            buffer-size percent 1;
            priority strict-high;
        }
        1GE-H2 {
            transmit-rate percent 95;
            buffer-size percent 95;
            priority high;
        }
        1GE-BE {
            transmit-rate {
                remainder;
            }
            buffer-size {
                remainder;
            }
            priority low;
        }
        1GE-L1 {
            transmit-rate percent 1;
            buffer-size percent 1;
            priority medium-high;
        }
        1GE-AF {                        
            transmit-rate percent 1;
            buffer-size percent 1;
            priority medium-high;
        }
    }
}
firewall {
    family inet {
        filter accept-bgp {
            apply-flags omit;
            term accept-bgp {
                from {
                    source-prefix-list {
                        bgp-neighbors;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port bgp;
                }
                then {
                    count accept-bgp;
                    accept;
                }
            }
        }
        filter accept-ldp {
            apply-flags omit;
            term accept-ldp-discover {
                from {
                    source-prefix-list {
                        router-ipv4;
                    }
                    destination-prefix-list {
                        multicast-all-routers;
                    }
                    protocol udp;
                    destination-port ldp;
                }
                then {
                    count accept-ldp-discover;
                    accept;
                }
            }                           
            term accept-ldp-unicast {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port ldp;
                }
                then {
                    count accept-ldp-unicast;
                    accept;
                }
            }
            term accept-tldp-discover {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port ldp;
                }
                then {
                    count accept-tldp-discover;
                    accept;
                }
            }
            term accept-ldp-igmp {
                from {
                    source-prefix-list {
                        router-ipv4;
                    }
                    destination-prefix-list {
                        multicast-all-routers;
                    }
                    protocol igmp;
                }
                then {
                    count accept-ldp-igmp;
                    accept;
                }
            }
        }
        filter accept-rsvp {
            apply-flags omit;
            term accept-rsvp {          
                from {
                    protocol rsvp;
                }
                then {
                    count accept-rsvp;
                    accept;
                }
            }
        }
        filter accept-bfd {
            apply-flags omit;
            term accept-bfd {
                from {
                    source-prefix-list {
                        router-ipv4;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    source-port 49152-65535;
                    destination-port 3784-3785;
                }
                then {
                    count accept-bfd;
                    accept;
                }
            }
        }
        filter accept-common-services {
            apply-flags omit;
            term accept-icmp {
                filter accept-icmp;
            }
            term accept-ssh {
                filter accept-ssh;
            }
            term accept-snmp {
                filter accept-snmp;
            }
            term accept-ntp {
                filter accept-ntp;
            }
            term accept-traceroute {
                filter accept-traceroute;
            }
            term accept-web {
                filter accept-web;
            }
            term accept-dns {
                filter accept-dns;
            }
            term accept-tacacs {
                filter accept-tacacs;
            }
        }
        filter accept-icmp {
            apply-flags omit;
            term no-icmp-fragments {
                from {
                    is-fragment;
                    protocol icmp;
                }
                then {
                    count no-icmp-fragments;
                    log;
                    discard;
                }
            }
            term accept-icmp {
                from {
                    protocol icmp;
                    icmp-type [ echo-reply echo-request time-exceeded unreachable source-quench router-advertisement parameter-problem ];
                }
                then {
                    policer management-5m;
                    count accept-icmp;
                    accept;
                }
            }
        }
        filter accept-ssh {
            apply-flags omit;
            term accept-ssh {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;    
                    }
                    protocol tcp;
                    port ssh;
                }
                then {
                    policer management-5m;
                    count accept-ssh;
                    accept;
                }
            }
        }
        filter accept-snmp {
            apply-flags omit;
            term accept-snmp {
                from {
                    source-prefix-list {
                        snmp-community-clients;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port snmp;
                }
                then {
                    policer management-5m;
                    count accept-snmp;
                    accept;
                }
            }
        }
        filter accept-ntp {
            apply-flags omit;
            term accept-ntp {
                from {
                    source-prefix-list {
                        ntp-servers;
                        localhost;
                        ntp-server;
                    }
                    destination-prefix-list {
                        router-ipv4;
                        localhost;
                    }
                    protocol udp;       
                    port ntp;
                }
                then {
                    policer management-1m;
                    count accept-ntp;
                    accept;
                }
            }
            term accept-ntp-peer {
                from {
                    source-prefix-list {
                        ntp-server-peers;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port ntp;
                }
                then {
                    policer management-1m;
                    count accept-ntp-peer;
                    accept;
                }
            }
            term accept-ntp-server {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port ntp;
                }
                then {
                    policer management-1m;
                    count accept-ntp-server;
                    accept;
                }
            }
        }
        filter accept-traceroute {
            apply-flags omit;           
            term accept-traceroute-udp {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    ttl 1;
                    destination-port 33435-33450;
                }
                then {
                    policer management-1m;
                    count accept-traceroute-udp;
                    accept;
                }
            }
            term accept-traceroute-icmp {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol icmp;
                    ttl 1;
                    icmp-type [ echo-request timestamp time-exceeded ];
                }
                then {
                    policer management-1m;
                    count accept-traceroute-icmp;
                    accept;
                }
            }
            term accept-traceroute-tcp {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    ttl 1;
                }
                then {
                    policer management-1m;
                    count accept-traceroute-tcp;
                    accept;
                }
            }
        }                               
        filter accept-web {
            apply-flags omit;
            term accept-web {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    destination-port [ http https ];
                }
                then {
                    policer management-5m;
                    count accept-web;
                    accept;
                }
            }
        }
        filter accept-dns {
            apply-flags omit;
            term accept-dns {
                from {
                    source-prefix-list {
                        dns-servers;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    source-port 53;
                }
                then {
                    policer management-1m;
                    count accept-dns;
                    accept;
                }
            }
        }
        filter accept-ftp {
            apply-flags omit;
            term accept-ftp {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port [ ftp ftp-data ];
                }
                then {
                    policer management-5m;
                    count accept-ftp;
                    accept;
                }
            }
        }
        filter accept-telnet {
            apply-flags omit;
            term accept-telnet {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    destination-port telnet;
                }
                then {
                    policer management-1m;
                    count accept-telnet;
                    accept;
                }
            }
        }
        filter accept-established {
            apply-flags omit;
            term accept-established-tcp-ssh {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port ssh;
                    tcp-established;
                }                       
                then {
                    policer management-5m;
                    count accept-established-tcp-ssh;
                    accept;
                }
            }
            term accept-established-tcp-ftp {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port ftp;
                    tcp-established;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-ftp;
                    accept;
                }
            }
            term accept-established-tcp-ftp-data-syn {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port ftp-data;
                    tcp-initial;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-ftp-data-syn;
                    accept;
                }
            }
            term accept-established-tcp-ftp-data {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port ftp-data;
                    tcp-established;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-ftp-data;
                    accept;
                }
            }
            term accept-established-tcp-telnet {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port telnet;
                    tcp-established;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-telnet;
                    accept;
                }
            }
            term accept-established-tcp-fetch {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port [ http https ];
                    tcp-established;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-fetch;
                    accept;
                }
            }
            term accept-established-udp-ephemeral {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port 49152-65535;
                }
                then {
                    policer management-5m;
                    count accept-established-udp-ephemeral;
                    accept;
                }
            }                           
        }
        filter discard-all {
            apply-flags omit;
            term discard-ip-options {
                from {
                    ip-options any;
                }
                then {
                    count discard-ip-options;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-TTL_1-unknown {
                from {
                    ttl 1;
                }
                then {
                    count discard-all-TTL_1-unknown;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-tcp {
                from {
                    protocol tcp;
                }
                then {
                    count discard-tcp;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-netbios {
                from {
                    protocol udp;
                    destination-port 137;
                }
                then {
                    count discard-netbios;
                    log;
                    syslog;             
                    discard;
                }
            }
            term discard-udp {
                from {
                    protocol udp;
                }
                then {
                    count discard-udp;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-icmp {
                from {
                    protocol icmp;
                }
                then {
                    count discard-icmp;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-unknown {
                then {
                    count discard-unknown;
                    log;
                    syslog;
                    discard;
                }
            }
        }
        filter accept-all {
            apply-flags omit;
            term accept-all-tcp {
                from {
                    protocol tcp;
                }
                then {
                    count accept-all-tcp;
                    log;
                    syslog;
                    accept;             
                }
            }
            term accept-all-udp {
                from {
                    protocol udp;
                }
                then {
                    count accept-all-udp;
                    log;
                    syslog;
                    accept;
                }
            }
            term accept-all-igmp {
                from {
                    protocol igmp;
                }
                then {
                    count accept-all-igmp;
                    log;
                    syslog;
                    accept;
                }
            }
            term accept-icmp {
                from {
                    protocol icmp;
                }
                then {
                    count accept-all-icmp;
                    log;
                    syslog;
                    accept;
                }
            }
            term accept-all-unknown {
                then {
                    count accept-all-unknown;
                    log;
                    syslog;
                    accept;
                }
            }
        }
        filter accept-pim {             
            apply-flags omit;
            term accept-pim {
                from {
                    source-prefix-list {
                        router-ipv4;
                        pim-rp;
                    }
                    destination-prefix-list {
                        router-ipv4;
                        pim;
                    }
                    protocol pim;
                }
                then {
                    count accept-pim;
                    accept;
                }
            }
        }
        filter accept-tacacs {
            apply-flags omit;
            term accept-tacacs {
                from {
                    source-prefix-list {
                        tacacs-server;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port tacacs;
                }
                then {
                    count accept-tacacs;
                    accept;
                }
            }
        }
        filter POLICY-INPUT-REDIRECT {
            term REDIRECT-TO-A05-CGNAT {
                from {
                    source-address {
                        100.65.0.0/16;
                    }
                }                       
                then {
                    routing-instance L3VPN-A05-CGNAT;
                }
            }
            term OTHERS {
                then accept;
            }
        }
        filter accept-igmp {
            apply-flags omit;
            term accept-igmp {
                from {
                    source-address {
                        0.0.0.0/0;
                    }
                    destination-prefix-list {
                        igmp;
                    }
                    protocol igmp;
                }
                then {
                    count accept-igmp;
                    accept;
                }
            }
        }
        filter REWRITE-DSCP {
            term REWRITE-DSCP {
                then {
                    loss-priority high;
                    forwarding-class BE;
                    dscp cs0;
                }
            }
        }
    }
    family inet6 {
        filter REWRITE-DSCPv6 {
            term REWRITE-DSCP {
                then {
                    loss-priority high;
                    forwarding-class BE;
                    traffic-class cs0;
                }
            }                           
        }
    }
    policer management-1m {
        apply-flags omit;
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 625k;
        }
        then discard;
    }
    policer management-5m {
        apply-flags omit;
        if-exceeding {
            bandwidth-limit 5m;
            burst-size-limit 625k;
        }
        then discard;
    }
    policer FTP-POLICER {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 256k;
        }
        then discard;
    }
    policer TELNET-POLICER {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 512k;
        }
        then discard;
    }
    policer SSH-POLICER {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 512k;
        }
        then discard;
    }
    policer SMALL-BW-POLICER {
        if-exceeding {
            bandwidth-limit 128k;
            burst-size-limit 64k;
        }
        then discard;                   
    }
    policer NTP-POLICER {
        if-exceeding {
            bandwidth-limit 128k;
            burst-size-limit 64k;
        }
        then discard;
    }
    policer ICMP-POLICER {
        if-exceeding {
            bandwidth-limit 128k;
            burst-size-limit 64k;
        }
        then discard;
    }
    policer VRRP-POLICER {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 128k;
        }
        then discard;
    }
    policer IGMP-POLICER {
        if-exceeding {
            bandwidth-limit 128k;
            burst-size-limit 64k;
        }
        then discard;
    }
    policer LIMIT-1M {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 625k;
        }
        then discard;
    }
    policer TCP-CONNECTION-POLICER {
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 512k;
        }
        then discard;
    }
    policer LIMIT-50M {
        if-exceeding {                  
            bandwidth-limit 50m;
            burst-size-limit 625k;
        }
        then discard;
    }
    policer LIMIT-2M {
        filter-specific;
        if-exceeding {
            bandwidth-limit 2m;
            burst-size-limit 375k;
        }
        then discard;
    }
    policer LIMIT-5M {
        if-exceeding {
            bandwidth-limit 5m;
            burst-size-limit 937500;
        }
        then discard;
    }
    filter PROTECT-RE {
        interface-specific;
        term MGT {
            from {
                source-address {
                    10.0.0.0/8 except;
                    192.168.0.0/16 except;
                    172.16.0.0/12 except;
                    27.2.225.0/24 except;
                    27.2.224.0/24 except;
                    112.197.4.0/24 except;
                    112.197.3.0/24 except;
                    27.2.192.0/24 except;
                    27.2.193.0/24 except;
                    112.197.0.0/16 except;
                    27.2.0.0/15 except;
                    0.0.0.0/0;
                    118.69.32.39/32 except;
                }
                protocol tcp;
                destination-port [ ssh telnet ];
            }
            then {
                count ROUTER-RE;
                discard;                
            }
        }
        term SMALL-PACKETS {
            from {
                packet-length 0-24;
            }
            then {
                count SMALL-PACKET-ATTACK;
                discard;
            }
        }
        term FRAGMENT-PACKETS {
            from {
                fragment-offset-except 0;
                protocol [ icmp igmp pim tcp ];
            }
            then {
                count FRAG-ATTACK;
                discard;
            }
        }
        term TCP-DOS-PROTECTION {
            from {
                source-prefix-list {
                    BGP-ADDRESSES;
                    LOCALHOST;
                    SSH-TELNET;
                }
                protocol tcp;
                tcp-flags "(syn & !ack) | fin | rst";
            }
            then {
                policer TCP-CONNECTION-POLICER;
                count TCP-SYN;
                next term;
            }
        }
        term BGP {
            from {
                source-prefix-list {
                    BGP-ADDRESSES;
                }
                protocol tcp;
                port bgp;
            }                           
            then {
                count BGP;
                accept;
            }
        }
        term OSPF {
            from {
                protocol ospf;
            }
            then {
                count OSPF;
                accept;
            }
        }
        term DHCPRELAY {
            from {
                protocol udp;
                destination-port bootps;
            }
            then {
                count DHCPRELAY;
                accept;
            }
        }
        term LDP {
            from {
                protocol [ tcp udp ];
                port ldp;
            }
            then {
                count LDP;
                accept;
            }
        }
        term RSVP {
            from {
                protocol rsvp;
            }
            then {
                count RSVP;
                accept;
            }
        }
        term PIM {
            from {                      
                protocol pim;
            }
            then {
                count PIM;
                accept;
            }
        }
        term IGMP {
            from {
                protocol igmp;
            }
            then {
                policer IGMP-POLICER;
                count IGMP;
                accept;
            }
        }
        term VRRP {
            from {
                destination-address {
                    224.0.0.18/32;
                }
                source-prefix-list {
                    INTERNAL-ADDRESSES;
                }
                protocol vrrp;
            }
            then {
                policer VRRP-POLICER;
                count VRRP-TRAFFIC;
                accept;
            }
        }
        term SNMP {
            from {
                source-prefix-list {
                    SNMP;
                }
                protocol udp;
                destination-port snmp;
            }
            then {
                count SNMP;
                accept;
            }                           
        }
        term NTP {
            from {
                source-address {
                    27.2.224.44/32;
                }
                source-prefix-list {
                    NTP-ADDRESSES;
                }
                protocol udp;
                port ntp;
            }
            then {
                policer NTP-POLICER;
                count NTP;
                accept;
            }
        }
        term MGMT-PING {
            from {
                source-prefix-list {
                    SSH-TELNET;
                    INTERNAL-ADDRESSES;
                }
                protocol icmp;
                icmp-type-except [ router-advertisement redirect ];
            }
            then {
                count MGMT-PING-TRAFFIC;
                accept;
            }
        }
        term PROTECT-ICMP {
            from {
                protocol icmp;
                icmp-type [ redirect mask-reply ];
            }
            then {
                discard;
            }
        }
        term ICMP {
            from {
                protocol icmp;
                icmp-type-except [ router-advertisement redirect ];
            }
            then {
                policer ICMP-POLICER;
                count ICMP-TRAFFIC;
                accept;
            }
        }
        term UDP-SERVICES {
            from {
                source-prefix-list {
                    SSH-TELNET;
                }
                protocol udp;
                source-port 1024-65535;
            }
            then {
                policer SMALL-BW-POLICER;
                count UDP-SERVICES-TRAFFIC;
                accept;
            }
        }
        term TACAC {
            from {
                source-prefix-list {
                    TACACPLUS;
                }
                port [ tacacs tacacs-ds ];
            }
            then {
                count TACAC;
                accept;
            }
        }
        term SSH {
            from {
                source-prefix-list {
                    SSH-TELNET;
                    INTERNAL-ADDRESSES;
                }
                protocol tcp;
                port ssh;
            }
            then {
                policer SSH-POLICER;
                count SSH;              
                accept;
            }
        }
        term TELNET {
            from {
                source-prefix-list {
                    SSH-TELNET;
                    INTERNAL-ADDRESSES;
                }
                protocol tcp;
                port telnet;
            }
            then {
                policer TELNET-POLICER;
                count TELNET;
                accept;
            }
        }
        term FTP {
            from {
                source-prefix-list {
                    SSH-TELNET;
                }
                protocol tcp;
                port [ ftp ftp-data ];
            }
            then {
                policer FTP-POLICER;
                count FTP;
                accept;
            }
        }
        term BFD {
            from {
                protocol udp;
                destination-port [ 3784 4784 ];
            }
            then {
                count BFD;
                accept;
            }
        }
        term MPLS-TRACE {
            from {
                protocol udp;           
                port 3503;
            }
            then {
                policer ICMP-POLICER;
                count MPLS-TRACE;
                accept;
            }
        }
        term DISCARD {
            then {
                count DENY-TO-ROUTING-ENGINE;
                syslog;
                discard;
            }
        }
    }
    filter INTERNAL-INTERNET-POLICY-REDIRECT {
        term INTERNAL-BYPASS-CGNAT {
            from {
                source-address {
                    100.64.0.0/10;
                }
                destination-address {
                    27.2.226.64/26;
                    27.2.194.64/26;
                    112.197.7.64/26;
                    112.197.10.64/26;
                    112.197.8.64/26;
                    112.197.12.64/26;
                    112.197.5.192/27;
                    112.197.13.64/26;
                    10.255.0.0/16;
                    112.197.1.0/24;
                    112.197.2.0/24;
                    112.197.5.0/24;
                    27.2.194.0/24;
                    112.197.0.64/26;
                    112.197.6.0/26;
                    112.197.9.0/26;
                    27.2.201.0/26;
                    112.197.47.254/32;
                    112.197.47.253/32;
                    112.197.13.0/26;
                    112.197.2.96/29;
                }                       
            }
            then accept;
        }
        term INTERNAL-REDIRECT-CGNAT-DNG-NEW {
            from {
                source-prefix-list {
                    PREFIX-REDIRECT-CGNAT-DNG;
                }
            }
            then {
                routing-instance L3VPN-CGNAT-DNG; ## 'L3VPN-CGNAT-DNG' is not defined
            }
        }
    }
    filter ACCEPT-ALL {
        term ACCEPT-ALL {
            then accept;
        }
    }
}

routing-options {
    route-distinguisher-id 10.254.200.254;
    forwarding-table {
        export LOAD-BALANCE-ALL;
    }
    interface-routes {
        rib-group inet INTERFACE-ROUTE-INSTANCE;
    }
    router-id 10.254.200.254;
    autonomous-system 45543;
    graceful-restart;
    rib-groups {
        INTERFACE-ROUTE-INSTANCE {
            import-rib [ inet.0 inet.2 ];
        }
        mcast-rpf-rib {
            export-rib inet.2;          
            import-rib inet.2;
        }
    }
}
protocols {
    isis {
        level 1 wide-metrics-only;
        level 2 wide-metrics-only;
        interface lo0.0 {
            passive;
            level 1 disable;
        }
        export REDISTRIBUTE-ROUTE-TO-ISIS;
        reference-bandwidth 10g;
        topologies ipv4-multicast;      
    }
    rsvp {
        interface ae0.0 {
            link-protection;
        }

    }
    pim {
        rib-group inet mcast-rpf-rib;
        rp {
            static {
                address 112.197.4.49;
            }
        }
        interface ae0.0 {
            mode sparse;
        }
    }
    bgp {
        group IBGP {
            type internal;
            description "RR CLIENT";
            local-address 10.254.200.254;
            family inet {
                unicast;
            }
            family inet-vpn {
                unicast;
            }
            family inet6 {
                labeled-unicast {
                    explicit-null;
                }
            }
            family inet6-vpn {
                any;
            }
            family l2vpn {
                signaling;
            }                           
            family inet-mvpn {
                signaling;
            }
            family inet6-mvpn {
                signaling;
            }
            family route-target;
            neighbor 112.197.4.41 {
                description HCM-RR-01;
                import IMP-HCM-RR-01;
                export EXP-HCM-RR-01;
                vpn-apply-export;
            }
			neighbor 27.2.192.4 {
                description HNI-RR-01;
                import IMP-HNI-RR-01;
                export EXP-HNI-RR-01;
                vpn-apply-export;
            }
        }
        
        log-updown;
    }
    ldp {
        track-igp-metric;
        interface lo0.0;
       
    }
    mpls {
        traffic-engineering {
            mpls-forwarding;
        }
        no-propagate-ttl;
        label-switched-path TO-HCM-MX960-01 {
            to 112.197.4.42;
            install 10.255.230.0/24 active;
            install 192.168.100.0/24 active;
            install 172.16.0.0/12 active;
            install 10.255.255.0/24 active;
            install 10.255.254.0/24 active;
            optimize-timer 120;
        }
        ipv6-tunneling;
        interface ae0.0;
       
    }
    lldp {
        interface all;
    }
}
