
system {
    host-name Zero_Touch;
    domain-name sctv.vn;
    time-zone Asia/Saigon;
    authentication-order [ tacplus password ];
    root-authentication {
        encrypted-password "$1$amuqJ6yt$v/A3JhHyVTk.Mfe0s.tm6."; ## SECRET-DATA
    }
    name-server {
        112.197.1.8;
    }
    tacplus-server {
        10.255.255.251 {
            port 49;
            secret "$9$ZZDqfn/C01R/CORcSW8LX7Vbs2goGUjNd2aJG.m"; ## SECRET-DATA
            source-address 10.254.200.254;
        }
        10.255.253.2 {
            port 49;
            secret "$9$UMimT/CtBRhCt1hyrLXx7-ws24oJDjHdb4ZGDPf"; ## SECRET-DATA
            source-address 10.254.200.254;
        }
    }
    inactive: accounting {
        events [ login change-log interactive-commands ];
        destination {
            tacplus {
                server {
                    10.255.255.251 {
                        secret "$9$0kPq1clLxNw24xNs4JZq.mP5F369CtOBITz9puOSy"; ## SECRET-DATA
                        source-address 10.254.200.254;
                    }
                    10.255.253.2 {
                        secret "$9$0kPq1clLxNw24xNs4JZq.mP5F369CtOBITz9puOSy"; ## SECRET-DATA
                        source-address 10.254.200.254;
                    }
                }
            }
        }
    }
    allow-v4mapped-packets;
    login {
        retry-options {
            tries-before-disconnect 4;  
            backoff-threshold 2;
            backoff-factor 5;
            minimum-time 40;
        }
        class operators {
            idle-timeout 10;
            permissions [ clear configure firewall firewall-control interface-control network rollback view view-configuration ];
            allow-configuration-regexps [ "protocols isis" routing-instances ];
            deny-configuration-regexps [ chassis access accounting-options apply-groups forwarding-options groups policy-options services snmp system ethernet-switching-options routing-options poe class-of-service jsrc jsrc-partition multicast-snooping-options dynamic-profiles diameter unified-edge switch-options fabric ];
        }
        class super-user-local {
            idle-timeout 5;
            permissions [ configure view-configuration ];
            allow-commands "^show.*|^ping.*|^traceroute.*";
            deny-commands "^set*|^rename*|^clear*|^delete";
            deny-configuration "^set.*|^clear.*|^delete.*|^rename.*";
        }
        class view-config {
            idle-timeout 5;
            permissions [ secret view view-configuration ];
        }
        class view-interfaces {
            permissions [ interface view ];
            allow-commands "show interfaces diagnostics optics.*|show interfaces .*|exit*|monitor interface .*|(^ping .*host.*)|show chassis (routing-engine|environment|hardware)";
            deny-commands .*;
        }
        user Superuser {
            uid 2008;
            class super-user;
        }
        user lenq {
            uid 2005;
            class super-user;
            authentication {
                encrypted-password "$sha1$23382$RjT/a/Ck$ngrmqWQWQ1Ar2GJ8o11oxzIK9bbA"; ## SECRET-DATA
            }
        }
        user nghiatm {
            uid 2009;
            class super-user;
            authentication {
                encrypted-password "$sha1$23867$R1slATy2$tw3aMVNbpfEOMyisvJ3X88WWMGIh"; ## SECRET-DATA
            }                           
        }
        user operators {
            uid 2012;
            class operators;
        }
        user view-config {
            uid 2000;
            class view-config;
        }
        user viewinterface {
            uid 2002;
            class view-interfaces;
        }
        password {
            format sha1;
        }
    }
    services {
        ftp;
        ssh {
            root-login deny;
            protocol-version v2;
        }
        telnet {
            rate-limit 5;
        }
		netconf {
            ssh;
        }
    }
    syslog {
        user * {
            any emergency;
        }
        host 10.255.254.212 {
            any notice;
            source-address 10.254.200.254;
        }
        host 10.255.254.235 {
            any notice;
            port 12003;
            source-address 10.254.200.254;
        }
        host 10.255.254.128 {
            any notice;
            port 12004;
            source-address 10.254.200.254;
        }                               
        file messages {
            any notice;
        }
        file interactive-commands {
            interactive-commands any;
        }
        file interface_status {
            daemon info;
            match "(SNMP_TRAP_LINK_UP|SNMP_TRAP_LINK_DOWN)";
            explicit-priority;
        }
    }
    archival {
        configuration {
            transfer-on-commit;
            archive-sites {
                "ftp://user:userviewconfig@112.197.47.224";
            }
        }
    }
    ntp {
        server 112.197.1.8;
        source-address 10.254.200.254;
    }
}
chassis {
    aggregated-devices {
        ethernet {
            device-count 25;
        }
    }
    fpc 0 {
        pic 0 {
            tunnel-services;
        }
    }
    alarm {
        management-ethernet {
            link-down ignore;
        }
    }
    network-services enhanced-ip;
}
interfaces {
    
    lo0 {
        unit 0 {
            family inet {
                filter {
                    input-list [ accept-bgp accept-bfd accept-ldp accept-rsvp accept-common-services accept-established accept-pim accept-igmp discard-all ];
                }
                address 10.254.200.254/32;
            }
            family iso {
                address 49.0003.0102.5420.0254.00;
            }
            family inet6 {
                address 2403:e200::ffff:10.254.200.254/128;
            }
        }
    }
}
snmp {
    location Zero_Touch;
    contact ROUTER;                     
    filter-duplicates;
    community sctvcommx5 {
        authorization read-only;
        clients {
            10.255.254.212/32;
            10.255.230.250/32;
            10.255.230.251/32;
            112.197.1.59/32;
            112.197.47.224/32;
            112.197.1.52/32;
            172.16.123.224/32;
            112.197.47.225/32;
            172.16.123.225/32;
            112.197.47.23/32;
            112.197.47.22/32;
            112.197.47.19/32;
            112.197.47.223/32;
            112.197.12.150/32;
            112.197.47.28/32;
            172.16.123.83/32;
            172.16.123.2/32;
            10.255.254.196/32;
        }
    }
    routing-instance-access;
}
routing-options {
    graceful-restart;
    interface-routes {
        rib-group inet INTERFACE-ROUTE-INSTANCE;
    }
    rib-groups {
        INTERFACE-ROUTE-INSTANCE {
            import-rib [ inet.0 inet.2 ];
        }
        mcast-rpf-rib {
            export-rib inet.2;
            import-rib inet.2;
        }
    }
    router-id 10.254.200.254;
    route-distinguisher-id 10.254.200.254;
    autonomous-system 45543;
    forwarding-table {
        export LOAD-BALANCE-ALL;        
    }
}
protocols {
    rsvp {
        interface ae0.0 {
            link-protection;
        }
        
    }
    mpls {
        traffic-engineering {
            mpls-forwarding;
        }
        ipv6-tunneling;
        label-switched-path TO-HCM-MX960-01 {
            to 112.197.4.42;
            install 10.255.230.0/24 active;
            install 192.168.100.0/24 active;
            install 172.16.0.0/12 active;
            install 10.255.255.0/24 active;
            install 10.255.254.0/24 active;
            optimize-timer 180;
        }
       
        interface ae0.0;
       
    }
    bgp {
        log-updown;
        group IBGP {
            type internal;
            description "RR CLIENT";
            local-address 10.254.200.254;
            family inet {
                unicast;
                labeled-unicast {       
                    rib {
                        inet.3;
                    }
                }
            }
            family inet-vpn {
                unicast;
            }
            family inet6 {
                labeled-unicast {
                    explicit-null;
                }
            }
            family inet6-vpn {
                any;
            }
            family l2vpn {
                signaling;
            }
            family inet-mvpn {
                signaling;
            }
            family inet6-mvpn {
                signaling;
            }
            family route-target;
            neighbor 112.197.4.41 {
                description HCM-RR-01;
                import IMP-HCM-RR-01;
                export EXP-HCM-RR-01;
                vpn-apply-export;
            }
            neighbor 27.2.192.4 {
                description HNI-RR-01;
                import IMP-HNI-RR-01;
                export EXP-HNI-RR-01;
                vpn-apply-export;
            }
        }
    }
    isis {
        export REDISTRIBUTE-ROUTE-TO-ISIS;
        reference-bandwidth 10g;
        topologies ipv4-multicast;
        level 1 wide-metrics-only;      
        level 2 wide-metrics-only;
       
        interface lo0.0 {
            passive;
            level 1 disable;
        }
    }
    ldp {                               
        track-igp-metric;
        interface lo0.0;
    }
    pim {
        rib-group inet mcast-rpf-rib;
        rp {
            static {
                address 112.197.4.49;
            }
        }
       
        interface ae0.0 {
            mode sparse;
        }
    }
    lldp {
        interface all;
    }                                   
}
policy-options {
    prefix-list bgp-neighbors {
        apply-path "protocols bgp group <*> neighbor <*>";
    }
    prefix-list router-ipv4 {
        apply-path "interfaces <*> unit <*> family inet address <*>";
    }
    prefix-list multicast-all-routers {
        224.0.0.2/32;
    }
    prefix-list rfc1918 {
        10.0.0.0/8;
        172.16.0.0/12;
        192.168.0.0/16;
    }
    prefix-list snmp-community-clients {
        apply-path "snmp community <*> clients <*>";
    }
    prefix-list ntp-servers {
        apply-path "system ntp server <*>";
    }
    prefix-list localhost {
        127.0.0.0/8;
    }
    prefix-list ntp-server-peers {
        apply-path "system ntp peer <*>";
    }
    prefix-list dns-servers {
        apply-path "system name-server <*>";
    }
    prefix-list tacacs-server {
        apply-path "system tacplus-server <*>";
    }
    prefix-list pim {
        224.0.0.13/32;
    }
    prefix-list tacas-servers {
        apply-path "system tacplus-server <*>";
    }
    prefix-list ntp-server {
        apply-path "system ntp server <*>";
    }
    prefix-list igmp {
        224.0.0.0/4;                    
    }
    prefix-list pim-rp {
        112.197.4.49/32;
    }
    policy-statement EXP-HCM-RR-01 {
        term REDISTRIBUTE-ISIS-ROUTE {
            from {
                protocol isis;
                level 1;
                route-filter 27.2.0.0/15 orlonger;
                route-filter 112.197.0.0/16 orlonger;
                route-filter 100.64.0.0/10 orlonger;
                route-filter 172.16.0.0/12 longer;
                route-filter 10.0.0.0/8 longer;
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
        term REDISTRIBUTE-STATIC-ROUTE {
            from {
                protocol static;
                route-filter 27.2.0.0/15 orlonger;
                route-filter 112.197.0.0/16 orlonger;
                route-filter 100.64.0.0/10 orlonger;
                route-filter 172.16.0.0/12 longer;
                route-filter 10.0.0.0/8 longer;
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
    }
    policy-statement EXP-HNI-RR-01 {
        term REDISTRIBUTE-ISIS-ROUTE {
            from {
                protocol isis;
                level 1;
                route-filter 27.2.0.0/15 orlonger;
                route-filter 112.197.0.0/16 orlonger;
                route-filter 100.64.0.0/10 orlonger;
                route-filter 172.16.0.0/12 longer;
                route-filter 10.0.0.0/8 longer;
            }
            then {
                local-preference 600;
                community set COMM-LOCAL;
                next-hop self;
                accept;
            }
        }
    }
    policy-statement IMP-HCM-RR-01 {
        term ACCEPT-ALL {
            then accept;
        }
        term REJECT {
            then reject;
        }
    }
    policy-statement IMP-HNI-RR-01 {
        term ACCEPT-ALL {
            then {
                local-preference 100;
                accept;
            }
        }
        term REJECT {
            then reject;
        }
    }
    policy-statement LOAD-BALANCE-ALL {
        then {
            load-balance per-packet;
        }
    }
    policy-statement REDISTRIBUTE-ROUTE-TO-ISIS {
        term L1-TO-L2 {
            from {
                protocol isis;
                level 1;
            }
            to {
                protocol isis;          
                level 2;
            }
            then reject;
        }
    }
    community COMM-LOCAL members [ 45543:5000 45543:54000 ];
}
class-of-service {
    classifiers {
        dscp CL-DSCP {
            forwarding-class BE {
                loss-priority low code-points 001000;
                loss-priority high code-points 000000;
            }
            forwarding-class AF {
                loss-priority low code-points 010010;
                loss-priority medium-low code-points af22;
                loss-priority medium-high code-points af23;
            }
            forwarding-class L1 {
                loss-priority low code-points 011010;
            }
            forwarding-class H2 {
                loss-priority low code-points 100010;
            }
            forwarding-class EF {
                loss-priority low code-points 101110;
            }
            forwarding-class NC {
                loss-priority low code-points 110000;
            }
        }
        exp CL-EXP {
            forwarding-class BE {
                loss-priority low code-points 001;
                loss-priority high code-points 000;
            }
            forwarding-class AF {
                loss-priority low code-points 010;
            }
            forwarding-class L1 {
                loss-priority low code-points 011;
            }
            forwarding-class H2 {
                loss-priority low code-points 100;
            }
            forwarding-class EF {
                loss-priority low code-points 101;
            }
            forwarding-class NC {
                loss-priority low code-points 110;
            }
        }
        inet-precedence CL-INET-PRECEDENCE {
            forwarding-class BE {
                loss-priority low code-points 001;
                loss-priority high code-points 000;
            }
            forwarding-class AF {
                loss-priority low code-points 010;
            }
            forwarding-class L1 {
                loss-priority low code-points 011;
            }
            forwarding-class H2 {
                loss-priority low code-points 100;
            }
            forwarding-class EF {
                loss-priority low code-points 101;
            }
            forwarding-class NC {
                loss-priority low code-points 110;
            }
        }
    }
    forwarding-classes {
        class NC queue-num 3;
        class EF queue-num 6;
        class H2 queue-num 5;
        class L1 queue-num 4;
        class AF queue-num 2;
        class BE queue-num 0;
    }
    interfaces {
        ge-*/*/* {
            scheduler-map queue-table;
            unit * {
                forwarding-class BE;
            }
        }                               
        xe-*/*/* {
            scheduler-map queue-table;
            unit * {
                forwarding-class BE;
            }
        }
        ae* {
            scheduler-map queue-table;
            unit * {
                forwarding-class BE;
            }
        }
        
    }
    rewrite-rules {
        dscp RW-DSCP {
            forwarding-class BE {
                loss-priority low code-point 001000;
                loss-priority high code-point 000000;
            }
            forwarding-class AF {
                loss-priority low code-point 010010;
                loss-priority medium-low code-point af22;
                loss-priority medium-high code-point af23;
            }
            forwarding-class L1 {
                loss-priority low code-point 011010;
            }
            forwarding-class H2 {
                loss-priority low code-point 100010;
            }
            forwarding-class EF {
                loss-priority low code-point 101110;
            }
            forwarding-class NC {
                loss-priority low code-point 110000;
            }
        }
        exp RW-EXP {
            forwarding-class BE {
                loss-priority low code-point 001;
                loss-priority high code-point 000;
            }
            forwarding-class AF {
                loss-priority low code-point 010;
            }
            forwarding-class L1 {
                loss-priority low code-point 011;
            }
            forwarding-class H2 {
                loss-priority low code-point 100;
            }
            forwarding-class EF {
                loss-priority low code-point 101;
            }
            forwarding-class NC {
                loss-priority low code-point 110;
            }
        }
    }
    scheduler-maps {
        queue-table {
            forwarding-class NC scheduler s-NC;
            forwarding-class BE scheduler s-BE;
            forwarding-class AF scheduler s-AF;
            forwarding-class L1 scheduler s-L1;
            forwarding-class H2 scheduler s-H2;
            forwarding-class EF scheduler s-EF;
        }
        queue-table-1ge {
            forwarding-class NC scheduler 1GE-NC;
            forwarding-class BE scheduler 1GE-BE;
            forwarding-class H2 scheduler 1GE-H2;
            forwarding-class EF scheduler 1GE-EF;
            forwarding-class AF scheduler 1GE-AF;
            forwarding-class L1 scheduler 1GE-L1;
        }
    }
    schedulers {
        s-NC {
            transmit-rate percent 1;
            buffer-size percent 1;
            priority high;
        }
        s-EF {
            transmit-rate percent 15;
            buffer-size percent 15;
            priority strict-high;
        }
        s-H2 {                          
            transmit-rate percent 30;
            buffer-size percent 30;
            priority high;
        }
        s-L1 {
            transmit-rate percent 15;
            buffer-size percent 15;
            priority medium-high;
        }
        s-AF {
            transmit-rate percent 10;
            buffer-size percent 10;
            priority medium-high;
        }
        s-BE {
            transmit-rate percent 29;
            buffer-size percent 29;
            priority low;
        }
        1GE-NC {
            transmit-rate percent 1;
            buffer-size percent 1;
            priority high;
        }
        1GE-EF {
            transmit-rate percent 1;
            buffer-size percent 1;
            priority strict-high;
        }
        1GE-H2 {
            transmit-rate percent 95;
            buffer-size percent 95;
            priority high;
        }
        1GE-BE {
            transmit-rate {
                remainder;
            }
            buffer-size {
                remainder;
            }
            priority low;
        }
        1GE-L1 {
            transmit-rate percent 1;    
            buffer-size percent 1;
            priority medium-high;
        }
        1GE-AF {
            transmit-rate percent 1;
            buffer-size percent 1;
            priority medium-high;
        }
    }
}
firewall {
    family inet {
        filter accept-bgp {
            apply-flags omit;
            term accept-bgp {
                from {
                    source-prefix-list {
                        bgp-neighbors;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port bgp;
                }
                then {
                    count accept-bgp;
                    accept;
                }
            }
        }
        filter accept-ldp {
            apply-flags omit;
            term accept-ldp-discover {
                from {
                    source-prefix-list {
                        router-ipv4;
                    }
                    destination-prefix-list {
                        multicast-all-routers;
                    }
                    protocol udp;
                    destination-port ldp;
                }
                then {                  
                    count accept-ldp-discover;
                    accept;
                }
            }
            term accept-ldp-unicast {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port ldp;
                }
                then {
                    count accept-ldp-unicast;
                    accept;
                }
            }
            term accept-tldp-discover {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port ldp;
                }
                then {
                    count accept-tldp-discover;
                    accept;
                }
            }
            term accept-ldp-igmp {
                from {
                    source-prefix-list {
                        router-ipv4;
                    }
                    destination-prefix-list {
                        multicast-all-routers;
                    }
                    protocol igmp;
                }
                then {
                    count accept-ldp-igmp;
                    accept;
                }
            }                           
        }
        filter accept-rsvp {
            apply-flags omit;
            term accept-rsvp {
                from {
                    protocol rsvp;
                }
                then {
                    count accept-rsvp;
                    accept;
                }
            }
        }
        filter accept-bfd {
            apply-flags omit;
            term accept-bfd {
                from {
                    source-prefix-list {
                        router-ipv4;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    source-port 49152-65535;
                    destination-port 3784-3785;
                }
                then {
                    count accept-bfd;
                    accept;
                }
            }
        }
        filter accept-common-services {
            apply-flags omit;
            term accept-icmp {
                filter accept-icmp;
            }
            term accept-ssh {
                filter accept-ssh;
            }
            term accept-snmp {
                filter accept-snmp;
            }
            term accept-ntp {           
                filter accept-ntp;
            }
            term accept-traceroute {
                filter accept-traceroute;
            }
            term accept-web {
                filter accept-web;
            }
            term accept-dns {
                filter accept-dns;
            }
            term accept-tacacs {
                filter accept-tacacs;
            }
        }
        filter accept-icmp {
            apply-flags omit;
            term no-icmp-fragments {
                from {
                    is-fragment;
                    protocol icmp;
                }
                then {
                    count no-icmp-fragments;
                    log;
                    discard;
                }
            }
            term accept-icmp {
                from {
                    protocol icmp;
                    icmp-type [ echo-reply echo-request time-exceeded unreachable source-quench router-advertisement parameter-problem ];
                }
                then {
                    policer management-5m;
                    count accept-icmp;
                    accept;
                }
            }
        }
        filter accept-ssh {
            apply-flags omit;
            term accept-ssh {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port ssh;
                }
                then {
                    policer management-5m;
                    count accept-ssh;
                    accept;
                }
            }
        }
        filter accept-snmp {
            apply-flags omit;
            term accept-snmp {
                from {
                    source-prefix-list {
                        snmp-community-clients;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port snmp;
                }
                then {
                    policer management-5m;
                    count accept-snmp;
                    accept;
                }
            }
        }
        filter accept-ntp {
            apply-flags omit;
            term accept-ntp {
                from {
                    source-prefix-list {
                        ntp-servers;
                        localhost;
                        ntp-server;
                    }
                    destination-prefix-list {
                        router-ipv4;
                        localhost;
                    }
                    protocol udp;
                    port ntp;
                }
                then {
                    policer management-1m;
                    count accept-ntp;
                    accept;
                }
            }
            term accept-ntp-peer {
                from {
                    source-prefix-list {
                        ntp-server-peers;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port ntp;
                }
                then {
                    policer management-1m;
                    count accept-ntp-peer;
                    accept;
                }
            }
            term accept-ntp-server {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port ntp;
                }
                then {
                    policer management-1m;
                    count accept-ntp-server;
                    accept;
                }                       
            }
        }
        filter accept-traceroute {
            apply-flags omit;
            term accept-traceroute-udp {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    ttl 1;
                    destination-port 33435-33450;
                }
                then {
                    policer management-1m;
                    count accept-traceroute-udp;
                    accept;
                }
            }
            term accept-traceroute-icmp {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol icmp;
                    ttl 1;
                    icmp-type [ echo-request timestamp time-exceeded ];
                }
                then {
                    policer management-1m;
                    count accept-traceroute-icmp;
                    accept;
                }
            }
            term accept-traceroute-tcp {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    ttl 1;
                }
                then {
                    policer management-1m;
                    count accept-traceroute-tcp;
                    accept;
                }
            }
        }
        filter accept-web {
            apply-flags omit;
            term accept-web {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    destination-port [ http https ];
                }
                then {
                    policer management-5m;
                    count accept-web;
                    accept;
                }
            }
        }
        filter accept-dns {
            apply-flags omit;
            term accept-dns {
                from {
                    source-prefix-list {
                        dns-servers;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    source-port 53;
                }
                then {
                    policer management-1m;
                    count accept-dns;
                    accept;
                }
            }
        }
        filter accept-ftp {             
            apply-flags omit;
            term accept-ftp {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port [ ftp ftp-data ];
                }
                then {
                    policer management-5m;
                    count accept-ftp;
                    accept;
                }
            }
        }
        filter accept-telnet {
            apply-flags omit;
            term accept-telnet {
                from {
                    source-prefix-list {
                        rfc1918;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    destination-port telnet;
                }
                then {
                    policer management-1m;
                    count accept-telnet;
                    accept;
                }
            }
        }
        filter accept-established {
            apply-flags omit;
            term accept-established-tcp-ssh {
                from {
                    destination-prefix-list {
                        router-ipv4;    
                    }
                    source-port ssh;
                    tcp-established;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-ssh;
                    accept;
                }
            }
            term accept-established-tcp-ftp {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port ftp;
                    tcp-established;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-ftp;
                    accept;
                }
            }
            term accept-established-tcp-ftp-data-syn {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port ftp-data;
                    tcp-initial;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-ftp-data-syn;
                    accept;
                }
            }
            term accept-established-tcp-ftp-data {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port ftp-data;
                    tcp-established;    
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-ftp-data;
                    accept;
                }
            }
            term accept-established-tcp-telnet {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port telnet;
                    tcp-established;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-telnet;
                    accept;
                }
            }
            term accept-established-tcp-fetch {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    source-port [ http https ];
                    tcp-established;
                }
                then {
                    policer management-5m;
                    count accept-established-tcp-fetch;
                    accept;
                }
            }
            term accept-established-udp-ephemeral {
                from {
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol udp;
                    destination-port 49152-65535;
                }
                then {
                    policer management-5m;
                    count accept-established-udp-ephemeral;
                    accept;
                }
            }
        }
        filter discard-all {
            apply-flags omit;
            term discard-ip-options {
                from {
                    ip-options any;
                }
                then {
                    count discard-ip-options;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-TTL_1-unknown {
                from {
                    ttl 1;
                }
                then {
                    count discard-all-TTL_1-unknown;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-tcp {
                from {
                    protocol tcp;
                }
                then {
                    count discard-tcp;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-netbios {
                from {
                    protocol udp;
                    destination-port 137;
                }                       
                then {
                    count discard-netbios;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-udp {
                from {
                    protocol udp;
                }
                then {
                    count discard-udp;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-icmp {
                from {
                    protocol icmp;
                }
                then {
                    count discard-icmp;
                    log;
                    syslog;
                    discard;
                }
            }
            term discard-unknown {
                then {
                    count discard-unknown;
                    log;
                    syslog;
                    discard;
                }
            }
        }
        filter accept-all {
            apply-flags omit;
            term accept-all-tcp {
                from {
                    protocol tcp;
                }
                then {                  
                    count accept-all-tcp;
                    log;
                    syslog;
                    accept;
                }
            }
            term accept-all-udp {
                from {
                    protocol udp;
                }
                then {
                    count accept-all-udp;
                    log;
                    syslog;
                    accept;
                }
            }
            term accept-all-igmp {
                from {
                    protocol igmp;
                }
                then {
                    count accept-all-igmp;
                    log;
                    syslog;
                    accept;
                }
            }
            term accept-icmp {
                from {
                    protocol icmp;
                }
                then {
                    count accept-all-icmp;
                    log;
                    syslog;
                    accept;
                }
            }
            term accept-all-unknown {
                then {
                    count accept-all-unknown;
                    log;
                    syslog;
                    accept;             
                }
            }
        }
        filter accept-pim {
            apply-flags omit;
            term accept-pim {
                from {
                    source-prefix-list {
                        router-ipv4;
                        pim-rp;
                    }
                    destination-prefix-list {
                        router-ipv4;
                        pim;
                    }
                    protocol pim;
                }
                then {
                    count accept-pim;
                    accept;
                }
            }
        }
        filter accept-tacacs {
            apply-flags omit;
            term accept-tacacs {
                from {
                    source-prefix-list {
                        tacacs-server;
                    }
                    destination-prefix-list {
                        router-ipv4;
                    }
                    protocol tcp;
                    port tacacs;
                }
                then {
                    count accept-tacacs;
                    accept;
                }
            }
        }
        filter POLICY-INPUT-REDIRECT {
            term INTERNAL-BYPASS-CGNAT {
                from {                  
                    source-address {
                        100.64.0.0/10;
                    }
                    destination-address {
                        112.197.0.0/16;
                    }
                }
                then accept;
            }
            term REDIRECT-TO-EX8208 {
                from {
                    source-address {
                        100.64.0.0/10;
                    }
                }
                then {
                    routing-instance L3VPN-SCTV-CGNAT; ## 'L3VPN-SCTV-CGNAT' is not defined
                }
            }
            term REDIRECT-TO-SWLOCAL {
                from {
                    destination-address {
                        10.255.240.0/24;
                        192.168.0.0/16;
                        10.255.254.251/32;
                        10.255.254.14/32;
                    }
                }
                then {
                    routing-instance L3VPN-SCTV-CGNAT; ## 'L3VPN-SCTV-CGNAT' is not defined
                }
            }
            term OTHERS {
                then accept;
            }
        }
        filter accept-igmp {
            apply-flags omit;
            term accept-igmp {
                from {
                    source-address {
                        0.0.0.0/0;
                    }
                    destination-prefix-list {
                        igmp;           
                    }
                    protocol igmp;
                }
                then {
                    count accept-igmp;
                    accept;
                }
            }
        }
    }
    policer management-1m {
        apply-flags omit;
        if-exceeding {
            bandwidth-limit 1m;
            burst-size-limit 625k;
        }
        then discard;
    }
    policer management-5m {
        apply-flags omit;
        if-exceeding {
            bandwidth-limit 5m;
            burst-size-limit 625k;
        }
        then discard;
    }
}

